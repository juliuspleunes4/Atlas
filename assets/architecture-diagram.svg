<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 900">
  <defs>
    <style>
      .title { font: bold 24px sans-serif; fill: #2c3e50; }
      .subtitle { font: bold 16px sans-serif; fill: #34495e; }
      .text { font: 14px sans-serif; fill: #2c3e50; }
      .small-text { font: 12px sans-serif; fill: #7f8c8d; }
      .box { fill: #3498db; stroke: #2980b9; stroke-width: 2; }
      .component { fill: #ecf0f1; stroke: #95a5a6; stroke-width: 2; }
      .attention { fill: #e74c3c; stroke: #c0392b; stroke-width: 2; }
      .mlp { fill: #f39c12; stroke: #e67e22; stroke-width: 2; }
      .embed { fill: #9b59b6; stroke: #8e44ad; stroke-width: 2; }
      .output { fill: #2ecc71; stroke: #27ae60; stroke-width: 2; }
      .arrow { fill: none; stroke: #34495e; stroke-width: 2; marker-end: url(#arrowhead); }
      .label-bg { fill: white; stroke: none; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#34495e" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="400" y="35" text-anchor="middle" class="title">Atlas Transformer Architecture</text>
  <text x="400" y="55" text-anchor="middle" class="small-text">Decoder-only GPT-style Language Model</text>
  
  <!-- Input -->
  <rect x="300" y="80" width="200" height="50" rx="5" class="component"/>
  <text x="400" y="110" text-anchor="middle" class="text">Input Tokens</text>
  <text x="400" y="125" text-anchor="middle" class="small-text">[batch, seq_len]</text>
  
  <line x1="400" y1="130" x2="400" y2="160" class="arrow"/>
  
  <!-- Token Embeddings -->
  <rect x="250" y="160" width="150" height="60" rx="5" class="embed"/>
  <text x="325" y="185" text-anchor="middle" class="text" fill="white">Token</text>
  <text x="325" y="205" text-anchor="middle" class="text" fill="white">Embeddings</text>
  
  <!-- Positional Embeddings -->
  <rect x="420" y="160" width="150" height="60" rx="5" class="embed"/>
  <text x="495" y="185" text-anchor="middle" class="text" fill="white">Positional</text>
  <text x="495" y="205" text-anchor="middle" class="text" fill="white">Embeddings</text>
  
  <!-- Merge -->
  <text x="410" y="245" text-anchor="middle" class="text">+</text>
  <line x1="325" y1="220" x2="395" y2="250" class="arrow"/>
  <line x1="495" y1="220" x2="425" y2="250" class="arrow"/>
  <line x1="410" y1="255" x2="410" y2="285" class="arrow"/>
  
  <!-- Transformer Block Container -->
  <rect x="180" y="285" width="440" height="400" rx="10" class="component" fill="#f8f9fa"/>
  <text x="400" y="310" text-anchor="middle" class="subtitle">Transformer Block (×N layers)</text>
  
  <!-- Layer Norm 1 -->
  <rect x="310" y="325" width="180" height="35" rx="5" class="component"/>
  <text x="400" y="347" text-anchor="middle" class="text">Layer Norm</text>
  
  <line x1="400" y1="360" x2="400" y2="380" class="arrow"/>
  
  <!-- Multi-Head Attention -->
  <rect x="250" y="380" width="300" height="80" rx="5" class="attention"/>
  <text x="400" y="410" text-anchor="middle" class="text" fill="white">Multi-Head Self-Attention</text>
  <text x="400" y="430" text-anchor="middle" class="small-text" fill="white">Q, K, V projections → Attention → Output</text>
  <text x="400" y="448" text-anchor="middle" class="small-text" fill="white">Causal masking (autoregressive)</text>
  
  <!-- Residual 1 -->
  <line x1="400" y1="285" x2="150" y2="285" class="arrow" stroke-dasharray="5,5"/>
  <line x1="150" y1="285" x2="150" y2="420" class="arrow" stroke-dasharray="5,5"/>
  <line x1="150" y1="420" x2="230" y2="420" class="arrow" stroke-dasharray="5,5"/>
  <text x="155" y="355" class="small-text">residual</text>
  
  <line x1="400" y1="460" x2="400" y2="480" class="arrow"/>
  <text x="415" y="472" text-anchor="start" class="small-text">+</text>
  
  <!-- Layer Norm 2 -->
  <rect x="310" y="485" width="180" height="35" rx="5" class="component"/>
  <text x="400" y="507" text-anchor="middle" class="text">Layer Norm</text>
  
  <line x1="400" y1="520" x2="400" y2="540" class="arrow"/>
  
  <!-- MLP -->
  <rect x="250" y="540" width="300" height="80" rx="5" class="mlp"/>
  <text x="400" y="570" text-anchor="middle" class="text" fill="white">Feed-Forward Network (MLP)</text>
  <text x="400" y="590" text-anchor="middle" class="small-text" fill="white">Linear → GELU → Linear</text>
  <text x="400" y="608" text-anchor="middle" class="small-text" fill="white">hidden × 4 expansion</text>
  
  <!-- Residual 2 -->
  <line x1="400" y1="480" x2="640" y2="480" class="arrow" stroke-dasharray="5,5"/>
  <line x1="640" y1="480" x2="640" y2="580" class="arrow" stroke-dasharray="5,5"/>
  <line x1="640" y1="580" x2="570" y2="580" class="arrow" stroke-dasharray="5,5"/>
  <text x="645" y="530" class="small-text">residual</text>
  
  <line x1="400" y1="620" x2="400" y2="655" class="arrow"/>
  <text x="415" y="640" text-anchor="start" class="small-text">+</text>
  
  <!-- Loop indicator -->
  <text x="400" y="675" text-anchor="middle" class="small-text" style="font-style: italic">↻ Repeat for N layers (6-30 layers typical)</text>
  
  <line x1="400" y1="685" x2="400" y2="715" class="arrow"/>
  
  <!-- Final Layer Norm -->
  <rect x="310" y="715" width="180" height="40" rx="5" class="component"/>
  <text x="400" y="740" text-anchor="middle" class="text">Final Layer Norm</text>
  
  <line x1="400" y1="755" x2="400" y2="785" class="arrow"/>
  
  <!-- LM Head -->
  <rect x="280" y="785" width="240" height="60" rx="5" class="output"/>
  <text x="400" y="810" text-anchor="middle" class="text" fill="white">Language Model Head</text>
  <text x="400" y="830" text-anchor="middle" class="small-text" fill="white">Project to vocab: [batch, seq, vocab_size]</text>
  
  <line x1="400" y1="845" x2="400" y2="870" class="arrow"/>
  
  <!-- Output -->
  <rect x="300" y="870" width="200" height="25" rx="5" class="component"/>
  <text x="400" y="887" text-anchor="middle" class="text">Output Logits</text>
  
  <!-- Side annotations -->
  <text x="50" y="120" class="small-text">Input</text>
  <text x="50" y="450" class="small-text">Transform</text>
  <text x="50" y="830" class="small-text">Output</text>
  
  <!-- Parameter info box -->
  <rect x="20" y="20" width="160" height="60" rx="5" fill="#ecf0f1" stroke="#95a5a6" stroke-width="1"/>
  <text x="100" y="40" text-anchor="middle" class="small-text" font-weight="bold">Model Configs</text>
  <text x="100" y="57" text-anchor="middle" class="small-text">TINY: 40M params</text>
  <text x="100" y="72" text-anchor="middle" class="small-text">ULTRA: 655M params</text>
</svg>
